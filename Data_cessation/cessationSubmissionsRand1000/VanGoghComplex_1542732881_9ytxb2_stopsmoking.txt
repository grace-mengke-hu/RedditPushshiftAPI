I can stop smoking - it's staying stopped that kicks me in the teeth

Over the past several years I've successfully quit smoking several times. I've stayed quit for time periods ranging from weeks to months, more than long enough to lose any shred of chemical dependency, more than long enough to start feeling much better and enjoying that feeling. I always eventually fail.

The help I need is in disassociating smoking from negative circumstances or emotions. The things that eventually get me to buy a pack are always similar - some stressful situation I'm in, be it a financial crunch, relationship problem, or just flat-out boredom.

It's incredibly discouraging to keep failing. I have two young kids and I want to be there for them. My father died of lung cancer 20 hours before his first grandson (my first son) was born. I don't want my kids to go through that.

I've tried vaping, patches, gum - these can all help me with the initial push, and get me through the toughest days of cutting the nicotine from my meat-machine, but I don't think they really play much of a role in the end. It's not a chemical dependency that I can't kick, it's the behavioral pattern.

Does anyone else have this issue? How do you tackle it?