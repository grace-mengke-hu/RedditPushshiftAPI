I managed to quit smoking for seven years, and now it looks like I'm hooked again. How do you manage the symptoms that lead to craving smokes?

I first started smoking when I was 19 after a huge screaming fight with my folks, none of my usual anti-stress exercises were working, went down to the store, bought a pack of smokes, and smoked for 2.5 years. Quit in January of 2012 because I had a new group of friends who wouldn't hang out with me if I had smoked recently because of the smell, and because I was sick of having bronchitis four times a year. I'm a naturally angry dude, have been since I was a little kid, and for me, having a smoke was always the ten minute breather I needed between "I'm so pissed I'm going to do something stupid" and "hey man, it isn't that big of a deal". 

When I quit smoking I switched to vaping until my vape (Blu) broke, then drinking, and while that's helpful after a long day, doesn't help me at work or in the middle of a stressful situation. Eventually my fiancee turned me on to weed (always hated the idea of breaking the law but they recreationally legalized it here a couple years ago so I was in the clear) and I've been using that to manage stress for the past couple years. Up until about two months ago I was in the 'have a couple puffs of weed before bed, maybe a couple beers on the weekend' camp and it was working really well for me. 

Well, about three months ago I got a really intense job that's been making me stupidly stressed out in my daily life, then two months ago I had another huge screaming fight with my folks. Dishes were broken on both sides, walls were punched, whole nine yards. I excused myself, they followed me screaming down the street a ways before I was far enough ahead where they couldn't catch up. I bought a pack and smoked almost the entire thing that night. Told myself it was a one time thing, then the next time I was out with friends about a week later I was bumming smokes the entire time, then the week after that they told me "if you're going to keep doing this just get your own" so I did. I've probably smoked about 10-14 packs in the past two months. 

I know I need to stop and I know I can do it because I've done it before. I know smoking calms me down when I'm stressed but I also know that it adds a feeling of stress and general unease in my daily life and that in the long run it doesn't help anything. I've tried medication, therapy, meditation, everything under the sun and I'm always just some combination of stressed out and pissed off. CBD works in the short term but you build up a tolerance real fast. 

How can I make sure that when I do quit, I'm not going to just do this again the next time I'm so angry I can't see in a straight line?