How do I quit smoking when my entire life is surrounded by smokers?

I smoke 4-7 cigarettes a day and I've been trying to quit, but it's really hard for me because everyone in my life smokes so even if I don't have any cigarettes somebody always offers me one.  It's really hard to turn down a free cigarette, especially when you have a really bad headache from nicotine withdrawal.  I can't remove myself from this environment.  I don't have money to move.  I live with my parents.  My mom smokes.  My girlfriend smokes. Almost all of my coworkers smoke.  I only have 1 friend who doesn't smoke.  I feel trapped in this cycle of trying to quit smoking and then giving up when I can't handle the nicotine withdrawal or the temptation of being offered a cigarette.