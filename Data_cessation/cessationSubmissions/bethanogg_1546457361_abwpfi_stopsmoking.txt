Advice on those moments of stress?

I've been smoking for a couple of years now, and last year gave up for about 40 days before a stressful event in my life pushed me back to it. This seems to be my biggest trigger (besides alcohol, which I've decided to abstain from this month to make giving up easier) so I was just wondering what advice you have for overcoming these moments of weakness? Haven't had one since new year's eve btw!