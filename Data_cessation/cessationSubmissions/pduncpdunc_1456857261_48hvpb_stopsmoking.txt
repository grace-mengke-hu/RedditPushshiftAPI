One year quit, starting to relapse. Need help or I will go back to smoking!

So a year ago today exactly, give or take a leap day, I quit smoking cigarettes "for good". I watched the Allen Carr video and it motivated and helped me immensely. I quit cold turkey from smoking about a pack a day, and I went 6 or 7 months without any amount of nicotine whatsoever. Even when I drank I had the willpower to resist nicotine urges, and I looked at smokers in a different light, like something to pity rather than envy, which is a feeling I had in past attempts to quit.

But then about three months ago things started to change. Breaking up with my girlfriend added stress in my life (she was also very helpful and motivational in getting me to quit in the first place), and my friends started smoking spliffs and I partook in that, not thinking it a big deal; sometimes I would get cocky at the bar and take a drag or two, just to prove that was all I needed and that it didn't matter. Slowly I started to smoke more. One day I had a full cigarette, and now I'll go out to the bar and just fiend like an addict. I'll see who I can ask for cigarette so I don't have to bum too many. A large majority of my friends smoke, so that makes them easier to get. Sometimes for a night out I'll smoke 5 or 6 (so not near where I used to be) but I can still feel the effects the next day and the cravings are stronger and more difficult to resist.

I have not yet bought a pack. This is the last barrier between full relapse, and I know if I buy a pack it will all be over. I feel like I'm dangling from a cliff, holding on with one hand and I don't know how long I can hold for. I tried watching the Allen Carr video again but it just didn't do it for me like the first time I watched it.

I don't really know what kind of advice people could give. Don't smoke. Quit again. Etc. Not sure what I need, maybe it's a solid kick right through the asshole, but I can't start smoking again, I will be so ashamed and disappointed with myself.

TLDR; quit for a while, starting to smoke again, don't want, plz halp

Edit: I realize that "started to relapse" is incorrect, I definitely have. Well, try try again. Here's to day 1! May it be the last. 