Trying this again...

Hi all - I'm 29 and I have been smoking for 10 years.  Once, about 4 years ago, I was able to quit for 4 months and I just gave up on a 6 week long attempt a few days ago.  Starting again today.  I've been lurking and reading lots of posts and this seems like an awesomely supportive community.

I've read Allen Carr's book and lots of content from WhyQuit.com and feel fairly educated on nicotine addiction and 99% of the time feel like I truly WANT to quit.  When I recently quit for 6 weeks I felt so much better and was so proud of myself throughout the process.  However, during previous attempts I have given in during low points - times when I was really upset or incredibly stressed out.  During these moments I would just say "Screw it!" and go on auto-pilot until I found myself smoking once again.  Any advice for someone who seems to have all the necessary ingredients but can't make it stick in those moments?