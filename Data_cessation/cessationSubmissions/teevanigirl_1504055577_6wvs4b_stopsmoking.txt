Liar

Started smoking around 15 quit at 33 when pregnant. Fast forward about 5 yrs have backslid back. Husband hates it. I have hid it and he found out  a few times and is mad because I have been lying. We have been together over 17 years.  He hates smoking and it makes him feel disgust for me.  I feel awful about lying. Life has been awful the past few months and I know they are excuses. I feel awful I have broken his trust. Want to stop so I can be with my family. He wants to separate and I love him so much. Any advice would be appreciated. 