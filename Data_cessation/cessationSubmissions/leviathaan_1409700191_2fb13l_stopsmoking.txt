Always relapsing. Any suggestions?

Hi there,

I am trying to quit now for years but the longest I was able to make it is a couple of months. When I go to drink with my buddies I get wasted and I always relapse. After a copule of weeks of smoking, I make a resolution again and again. I get through the worst part, I'm starting to feel good, then I relapse again. 
I made this so many times that I no longer take my quit seriously. 

You guys, who quit for good, do you have any suggestion to me?

 I have read Allan Carr countless of times, watched all Joel Spitzer videos on youtube, these are the best materials under the sun, I think. Still, I am where I was 5 years ago (the first time I read that bloody book. It was also my quit record, 3 months). Even worse, I no longer feel that happiness when I turn off "my last cigarette".

PS: 90% of the relapses occur when I am wasted. Did I answer my own question maybe? Should I just quit drinking alltogether? But I love booze...