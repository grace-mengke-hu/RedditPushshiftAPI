Smoking part-time. Help!

So I'm at my **fourth attempt at quitting** smoking in the past 5 weeks, **using NRT (patch) during the week, but relapsing on the weekends**. Clearly, I am doing something wrong, so any advice or criticism is welcome. Here are some themes or things I've noticed in the past 5 weeks:

* WEEK 1: First weekend after 5-6 days on the patch, I made the mistake of bumming **a smoke** when I was visiting NYC and went clubbing with friends, two of whom were smokers. These were people I just med and I wanted to blend in I guess, also was attracted to one of them. The next night I went out with friends and bummed **a few puffs** off a friend.

* WEEK 2: Since I relapsed, I reset my badge and started again on that first Sunday (1 week after first attempt); relapsed on Thanksgiving because I was feeling lonely and sad. Womp womp. Got **a pack** and smoked in within two days. Reset my badge and started again on Saturday.

* WEEK 3: Did well the first few days, no desire to smoke while at work or in the evenings, still on the patch, but come Thursday/Friday I caved in and smoked **another pack** over the weekend.

* WEEK 4: Held up till Friday, but had a pretty stressful week - got **a pack** on Friday night and finished it by Saturday. Went to NYC, got **another pack** and finished it by Sunday. Reset my badge and started again on Monday.

* WEEK 5: Doing well so far. I will have the occasional craving, but when I am busy at work or doing chores in the evening, the cravings are brief, and the patch keeps me in check. I am afraid when I go out tonight or tomorrow night and have a couple of drinks, I will feel the urge to smoke again. I have two **e-cigs** that I don't really use. I am running out of patches as well. I think from week 1 when I was super determined to quit until now my mindset has changed, and I feel like I am in control during the week, but on the weekend, I just let my guard down and end up smoking. I don't want to continue this vicious cycle. Even though smoking 2 out of 7 days is better than smoking all the time, it is not a solution. What should I do?!