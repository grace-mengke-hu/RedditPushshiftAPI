Dealing with stress

So I was a smoker for about 5 years. I've made numerous attempts to quit especially in the last year or so. I can count 5 since May 2014. In all but one of those attempts I failed while trying to deal with the feeling of frustration. In fact, I think its any unpleasant moment or feeling that makes me want to smoke. Even the cigarette after dinner I can make myself forget about and after a couple of days I don't even think about it any more. The first thought in my head the moment I get frustrated is about cigarettes. I hate it. I feel like its only when I am smoking that I can think clearly, deal with the situation and find a solution. I just managed to get through a frustrating moment but I feel like until I can figure out a coping mechanism its only a matter of time before something sets me off and I light up again. Even Allan Carr seems to say that you have to stick it out for a while as far as stress cigarettes are concerned. How did you handle stress and unpleasant moments? Thanks!