I really need advice about quiiting smoking while my SO is still a smoker.

A little background... I see my girlfriend on weekends however she will be moving in at the end of June and while she has been a smoker for years I have only been smoking for about 5 months at the most. I find that smoking is starting to cause some serious problems with me (I had my first nearly fatal asthma attack in 3 years last week). What's worse is I was smoking anywhere from 11 - 14 cigs a day and on bad days I would have one about every 20 minutes. I have tried to quit multiple times using multiple strategies (nicorette gum,  nicotine free e-health cigs, drinking tea to compensate) and nothing has worked. As soon as my gilfrind gets here and I see her having a smoke the cravings get terrible and it's all I can think about and I hate to say it but I have relapsed many times from this situation. What really bothers me is if I ask for a drag and she says no I get angry for some reason and it just isn't like me... I just need help, can anyone offer advice to help me quit while always being around a smoker? Constantly relapsing is making me feel pathetic,  stressed, and depressed...

TL; DR Girlfriend smokes,  I want to quit,  being near her smoking all the time makes quitting extremely hard so I really need advice.