What am I DOING?

I am 34. I used to smoke, since the age of about 14, and I quit at 25, using the Allen Carr book. About a year ago or so, I started having the odd social cigarette, thinking I could control it. My partner hates smoking, and I thought that'd be enough to stop me ever starting again. Also, I have two young children who I do not want to see me smoke, or in any way think smoking is normal. 
However, partner went away for a month. I suddenly thought, hmm, might have some wine tonight. Might BUY some cigarettes to go with my wine (???) I can control it, Ill just enjoy them til my partner is home. Throughout the month, I got up to about 4 a day, sometimes none, sometimes more than 4. Partner came home Sunday and I thought I was fine, til yesterday I felt horrible and stressed from my kids (not their fault) and told myself Ill go for a walk, Ill be fine, but as soon as my partner came home from work, I jumped in the car and went and bought a packet :(. Now Im a secret smoker! I feel absolutely terrible and guilty and kind of out of control. Im hiding it from my family and friends, and when I've said no more, my brain seems to freak out on me and I cave in. I know the theory, and I know Im better off without them. I dont know what I need r/stopsmoking, but any advice would be helpful! Do I confess, or fight this alone? What's this "craving" or whatever it is Im getting? Now there's a nearly full pack hiding in the shed and I need to get my head around throwing them out.
Thanks for listening to my confessional rant!