I am great at quitting. I do it all the time.

I have quit cold turkey before and it took for a month of so. But it never stays for good. I want to try again. Once I get a few days in it seems to get easier I take the mind set of not wanting to lose the work I put in. But when I go out with friends and I drink it is hard. I have failed there many times. How do I avoid lighting up again when I'm drunk? Giving up drinking is not an option I can only tackle one vice at a time. are there good substitutes? (not e-cigs?)