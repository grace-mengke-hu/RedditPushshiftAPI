6 months clean but too depressed to keep this up

I started smoking properly when I started university in Sept/Oct 2014.

I used to use it as a way to get out of certain social situations, as a way to meet new people, and as an alternative coping mechanism for self harm urges (e.g. I would smoke instead of engaging in self harm because it was “less bad”). Gradually it became an addiction and I was probably smoking 10-20 a day. I wanted to quit but all my friends/most of my housemates smoked and I didn’t care about my health because I was so depressed.

I took a leave of absence from university last summer because of my mental health, (before entering my final year so I am due to go back to finish my degree in Sept 2018/graduate in Summer 2019) and moved back home.  

I quit (cold turkey) in early August 2017 and haven’t had a cigarette since. 

Over the past week or so a lot of bad things have happened and I’ve been getting urges to smoke. Because I haven’t experienced these urges in months they feel quite strong and because I’m feeling depressed I don’t care enough not to smoke. The only reason I’ve not had a cigarette since the urges started is because I’m too depressed to leave my house to go to a shop to buy any. 

Additionally, I have to go back to university this week to sit an exam I failed last year. I’m going to meet up with an old friend I used to live with last year who smokes and I’m scared that if she offers me a cigarette I will say yes and ruin my non-smoking streak. It's easy to stay quit while I'm at home because I've never properly smoked while being here. The same isn't the case for my university city and I'm worried that returning to the place might result in me returning to my old habits.

I know cigarettes are bad and I don’t want to start smoking again but I’m so depressed that I feel urges to engage in self destructive behaviours (drinking and smoking and self harm - all of which I quit last year) and I don’t know how to resist. 