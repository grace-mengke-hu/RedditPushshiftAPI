Please help me. I'm fed up of my partners smoking.

FTP. Please excuse formatting and grammar. I'm on mobile and RAGING right now. 

We had a deal. He was going to buy a carton and once the carton was done, so was he. He was supposed to slowly wean off and then be done. But then the carton finished and he was stressed from being unemployed so I let it slide. Then the work picked up and the next pack was his last. But it wasn't. 

I'm so afraid the real last pack is never going to come. I am at my fucking witts end. I used to smoke and was a heavy smoker for a long time. But I quit and I hate it now. I am frustrated because he knows how much I hate it and it feels lile he is halfassed trying. He has terrible self discipline and control. He just keeps whining how hard it is and treats it like a joke when I express my concern. We have 2 roommates we live with who smoke too so of course that makes it so much harder because that group mentality takes over and I become the bad guy because I'm sitting angrily alone just watching from inside. 

He gave me his pack and told me to keep it and dish out smokes slowly throughout the day. I've hidden them and keep a count. But I found out he's been getting them off one of my roommates. I don't feel like I can talk to them about it without getting a "he's a grown up, let him be talk." I just sat down and tried writing out my feelings but it's just all emotion. 

I feel like nicotine is more important to him than me. He cares more about sneaking around smoking then trying to quit. I'm done. I wanna marry a man not a smelly, stinky child. Please help reddit. I'm lost and I don't know what to do anymore. 