How do I handle this kind of relapse?

So I'm sitting in this lounge with a few friends and getting pretty tipsy over the weekend. 

I suddenly realise I have a lit cigarette in my hand. 

I retch and cough and stub it out hurriedly realising what I have done. I curse my friends for not stopping me and myself for not realising what I was doing...

I think about the consequences. Am I going to need another puff sooner than later? What about my badge? I will have to reset it and start from scratch. Why am I such an absolute fuck up? Will I have the energy and the will power to quit again?

My friends, one laughs, the others semi-apologise, all indicating I have only myself to blame...

The kicker is, this was a dream. How do I hande this kind of relapse, Reddit? The usual relief of waking up from a bad dream doesn't work in this case. In fact, it's extremely draining waking up after one of these... and feeling like shit.