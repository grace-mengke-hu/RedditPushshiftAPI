Wanting to quit but don’t know how

I smoked for almost 10 years and finally quit successfully once. I stayed quit for 5 years and didn’t even think about it cravings now and then but I didn’t smoke. I had some moments where I got a bad craving and lit a cigarette only to find it gross and lit up but I didn’t start smoking during that time. Fast forward to 2016 when I started a new job and was dealing with stress and gradually picked it up again telling myself I wouldn’t get addicted again. But now I am :( I hate myself for it and feel guilty every time I smoke. It’s harder because my co workers who I like smoke and are constantly offering me cigarettes even though I have my own and we go on smoke breaks and such. I feel stupid and now I’m about a pack a day habit. I’m dealing with pretty bad depression and anger issues too. I have pretty low self esteem that most don’t know because I’m outwardly happy about it. I’d like to get healthier but don’t know how. I tried joining a gym last summer but my first workout I got nauseous and threw up and I felt like an idiot so stopped going. I feel like a failure. How can I stop and for good? My doctor mentioned chantix but I’m scared to take it because I’m afraid of medications like that don’t asks me why. Anyways I’m in a pretty dark lonely place right now and I’m really down about it. Hopefully someone else can relate to this if nothing else. 