Cannot believe I am here again

I quit smoking three years ago with help of Allen Carr's method. Last summer I met a man who is an occasional smoker and for some unknown reason I shared a cigarette with him and after that it has only gone downwards. I've tried to quit several times since, but am back with the habit only a few days later. The longest I held up was 3 weeks and thought I had made it. But no. I have re-read the book and decided to quit today. I know it is absolutely possible to be a happy non-smoker - I was one! But for some reason I am struggling to handle the cravings this time, even though they are less intense than when I initially stopped. 

Damn it, totally hate myself for being here again unable to quit. Anyone out there with advice?