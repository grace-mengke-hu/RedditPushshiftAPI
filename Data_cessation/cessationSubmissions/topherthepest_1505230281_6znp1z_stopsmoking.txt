Last night, I almost gave up 600+ days

So, for almost two years I've kept away from smoking. I quit cold turkey, drank less and hit the gym more. Last night, due to some complicated problems with an ex, I drank myself to almost asking for a cigarette. I had to just walk home before the craving won. It had been a loong time since there had been one that bad. It might just be time to give up the booze for a short while so I don't fall. Does anyone else get those sneaky cravings after a long time? How do you tell yourself no?