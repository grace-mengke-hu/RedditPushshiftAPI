Quitting again, need help to make it the final time

So I've tried to quit smoking about 5 times now, each time without telling anyone because I was too ashamed. I've thrown away more almost-full packs than I care to admit and just want to stop resorting to smoking as a way to make myself feel better and less depressed, even though I know it only makes things worse. 

Does anyone have suggestions for how to deal with a craving immediately? What are good ways to divert my attention when all I want to do is walk to the nearest convenience store and buy a fresh pack?