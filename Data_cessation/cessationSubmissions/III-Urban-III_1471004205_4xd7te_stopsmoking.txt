I've messed up big time and need advice.

So I managed to quit smoking for 2 years after having smoked for 9 years, but 2 weeks ago I did something really stupid.

So, I went to see a friend who smokes weed because I hadn't seen him in months, I also hadn't touched weed in 3 years which is what made giving up easier. Basically after a few drinks I manged to say no to the weed and went home, not a problem.

The following week I met the same friend again at another friends house, this became a problem at that point as there were 6 of us and I was the only one who wasn't smoking anything. 

Well, as the night went on and I drank some more, I ended up smoking some weed, but totally forgot about the tobacco inside. I wasn't pressured but I didnt feel like I could just sit there and NOT smoke, didn't want to be left out.

The morning after in my guilt, I ended up asking my partner for a roll up (rolled tobacco) and since then I've been smoking. I still feel I could break the habit however I know the addiction is creeping back up to me. 

I'm a bit pissed off with myself to be honest as throughout the 2 years I never had any craving to smoke. Even though my partner smokes and she's never given up, I never had the urge.

I'm not sure what to do now though because if it's possible for me to keep relapsing in social situations, I could be in danger of this happening every time. I already feel like shit every morning and stink of tobacco, my fingers becoming stained. 

I'm not sure what advice I'm asking for but I'm wondering if anyone else has had the same pitfall as me. Because my partner smokes it's all too easy to roll one up. She won't be able to give up either, this I know, because she never sticks at anything.

I have never felt so much regret from anything in my life when I smoked that spliff, It was so nice not having to worry about having a smoke at all.

I want to redeem myself before its too late and I'm hooked again.