I quit 5 years ago. here's my advice.

On a scale of 1 to 10, I would say the dificulty of quitting is 10+, hands down. I smoked cigs for about 15 years. Loved them, and felt quite depressed when I didn't have any, and worse of all was having to bum a cig. Made me feel low.

Anyways, I know fully well what you're going through. I was browsing and decided to give advice of my own, since I been there. It may not work for all, but if it works for one, my job is done.

Firstly, I think this will help mostly with the psychological part of it -- which imho is the reason why you keep going back to it weeks or even months after quitting. The physical withdrawal symptoms (the "pulling sensation in your muscles") last for only a day or less.

So, to get to it, my suggestion is to use self-hypnosis to get over the psychological part. To be more specific, use NLP. I won't get into NLP specifics now, but the main idea is to associate smoking with something you hate/detest/abhorr. Something you find absolutely repulsive/filhty. Make that suggestion/connection in your mind continuously so that each time the thought of smoking comes to your mind, you're immediately repelled by the thing you've mentally connected/associated it with.

Here's an example:

Every one (including you, I hope) cares about their looks. Right? And no one likes to have stained teeth. Do this now: google-image search "nicotine-stained teeth". Let those images stay with you. Let it stick in your mind as what will happen to you if you put that cig in your lips again. Would you like to look that ugly? Is that strong enough as a repellent?

I hope that helps, and it's the thing that keeps me from going back.