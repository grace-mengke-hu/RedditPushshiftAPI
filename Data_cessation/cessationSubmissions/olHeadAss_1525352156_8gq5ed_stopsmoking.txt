No motivation to quit anymore

I'm in the military so smoking is pretty conmon and accepted. Also I'm deployed, about to go home next month. 

I started smoking November 2016, my best friend in the army during training was a smoker and eventually I got into it, I'd smoke maybe 1-2 a day and never really thought it'd become a problem. Well a few months later I got to my permanent duty station and eventually it got worse to where I was going through a pack every 3-4 days going to the field constantly and just being stressed. 

August of 2017 I went to NTC (a month of simulated combat training in the Mohave desert) and I went through cartons that month because I was stressed and it gave me an excuse to take a break and get away from people. 

After NTC I went home on leave and my fiancé found out about me smoking and pretty much got me to quit after one conversation. Of course I've been tempted to smoke again but I never did because of her.

Well a month ago she found out that I used a dating app earlier in the relationship and met up with a girl and went to a party and kissed her and my fiancé just ended everything. I felt horrible about cheating since I did it but never brought it up to her. 

Well this past month I think I've smoked more than I have my whole life, I literally smoke every hour, my mind starts racing constantly just constantly thinking of her and how much I hate myself, I wake up having panic attacks and I just end up going out to smoke and calm down every night. 

I hate myself for smoking, I just look at the cigerette and start crying sometimes and I feel like I deserve whatever it's doing to my body. I was so happy and never wanted to smoke again, every time I was tempted I would think "how dissapointed would she be", now I feel like a complete dissapointment to everyone and I deserve to be a horrible person.

I go to the gym and have motivation to better myself as a person but those motivation bursts only last a couple hours and im immediately back to hating myself. I really don't know what to do, rereading all this seems like there's a lot more to me than just wanting to stop smoking. I've talked to therapists and I've reached out to other people but I just feel like I'm digging myself into a deeper and deeper hole every day no matter what I try to do