Tips anyone? Really need some help

My new girlfriend has something that she is at a greater risk of heart disease or something (she had a stroke in the past) and really wants me to quit.  I've been smoking for 5+ years and just installed an app (thanks to reading someone elses' thread.)

I've come very close a few times and have failed.  Whenever I do try and quit, I end up eating every piece of food in sight.  I'm bulking currently and stuck in the 150-160 but am still getting stronger, I'm just not sure what makes me give up each time.

My problem is social smoking (whenever I see someone) or just filling in the time.  I was wondering what has worked for people in the past.  How do you learn to say no when you're in the middle of a craving?  Do you stop hanging out with anyone that smokes to try and avoid the thoughts/urges?
Thanks Reddit, all of the advice is appreciated!

Edit:  I'd also become extremely over-tired, oversleep and I'd have really bad diarrhea as well, any tips for these stomach problems?
Edit2:  I also plan on purchasing an e-cig after work today, how effective are these for quitting?  If so, what brand/what kind has worked for you?