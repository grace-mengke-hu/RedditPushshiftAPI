I need to stop smoking when I drink.

I’ve been mostly successful in quitting smoking. I quit entirely around 5ish years ago but over the past year once in a while I get weak and will smoke socially or when drinking. It probably happens every few months or so. Last weekend I was on vacation and I get into a YOLO mode and go a bit crazy. I’m trying to shake the habit once again now because of last weekend, since the habit lingered a week later. It hasn’t always lingered this long, usually it lasts just one evening. 

I’m pretty upset at myself for going back at all. How do I manage to keep myself from being seduced when I’m with smoking friends and drinking? I can’t just stop going out with friends. 

Let me also just throw it out there that since quitting smoking, I’ve taken up running and I’ve found after smoking for a night, the next few days after my breathing during runs becomes far more labored and painful, and I usually have to cut the run way short than my usual goal. This is often why I have become so good at quitting, so I have a motivation obviously. I just wish I can stop 100%.

Anyone else have trouble with this?