Take the punishment.

I have a throbbing headache, literally seeing stars from it. This is my own damn fault. I will not take a painkiller because I need to feel this, take the punishment. Celebrated a friends birthday this afternoon and only one wine in, I already cave and light a cigarette. Smoked at least 6 more.
This always makes me realize why addicts shouldn't drink. I think it's silly to quit drinking to kick smoking, but I made this mistake way too often.
Anybody any good advice to help me not light one up the next time I have a drink with friends? I am practically a non-smoker as long as I don't have a drink in my hands (moderate drinker btw). I already quit buying packs for myself but now I find myself buying packs for friends so I can bum off them.

TLDR; only smoke when drinking, tips?