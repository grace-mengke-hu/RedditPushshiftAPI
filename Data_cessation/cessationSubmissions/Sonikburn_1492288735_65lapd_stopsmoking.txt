Need help not smoking while drinking

The title pretty much says it all.  I don't know what I'm doing wrong.  I used to smoke pretty heavily; I've been on and off for roughly 10-12 years.  I am at the point now that I can go Monday-Friday working my 8 hour days without even the slightest craving for a cigarette.  The second I go out with a group of friends on the weekends and start drinking, however, it's this immediate "I have to have one" feeling.  I have tried chewing gum, chewing on toothpicks, a nicotine patch, not bringing cigarettes at all -- nothing seems to work.  If I don't have them, after a couple beers I will drive however long I have to in order to get a pack.  The worst part is waking up the next day after a full week of not smoking to polishing off a pack in one night of drinking with some friends.  My lungs hurt, my body hurts, and I am morbidly disappointed in myself every single time.

Has anyone else had this problem?  What worked best for you?  I'm willing to try anything at this point, so I can finally put this smoking chapter of my life to bed.