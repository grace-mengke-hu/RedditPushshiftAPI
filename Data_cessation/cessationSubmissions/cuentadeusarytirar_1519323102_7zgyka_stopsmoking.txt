How to quit intermittent smoking

Hey quitters. Looking for advice on stopping an occasional habit.

I've been smoking on and off for 15 years. Sometimes I'll smoke semi regularly for 6 months, then stop for 6 months, but I always find a way back. 

I find my biggest problem is that when I'm out drinking (which is a big part advertising where I work), I let my guard down and buy a pack while I'm tipsy. Then once I have them in my possession I'll smoke half the pack then throw the other half away. I know I need to either curtail my drinking and/or exercise more willpower, but I think it'd help to hear that from some other people.

Any thoughts would be appreciated. Thanks!