Help needed from this awesome community !!

Hello Folks !!

I have been a smoker since i was 18 and I am 27 years old now. I have tried to quit smoking a couple of times before and failed. I have realized that drinking is the only time when I lose my self-control and give in to smoke a cigarette. Even during this attempt, I was going good until I went to a party. I am really tired of this. I have a feeling that I have to stop drinking for good if I want to stop smoking. But I really don't want to do that. I want to be a person who can drink in social occasions and still don't smoke. SO far all my previous 3 attempts have been foiled whenever I was at a party drinking(even if no one else smokes at the party.my friends are totally supportive too). Has anyone else had the same problem ? Can anyone help me out with this issue with some tips/tricks/techniques please ? If I have to stop drinking all together, I think I am ready to do that at this point f time. 

Any suggestions welcome guys.

P.S. I am not going to smoke again tomorrow. But the issue is it keeps adding on at several parties and one day I'm left with an empty packet of smokes the next day and it catches on.I'm totally aware that smoking even one cigarette is a failure. 