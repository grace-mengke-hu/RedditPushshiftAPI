So fed up

Hey all,

Felt the compulsion to write this post in utter frustration.

History:

Grew up with a smoking father, I always despised smoking

First time actually trying a cigarette: aged 7, no idea what I was doing, influenced by older friend. One drag and OUT. 

Then nothing until...
Full smoker since 18 (later starter) - gifted cig from friend after a break up
Started on 2 cigs a day, up to 10 a day in about a month.
Started Uni, smoking increased dramatically, on a bad day I could go through 40 cigs a day.

Left uni and smoking stabilised around 10 a day. 
Met my eventual wife (now ex wife) in 2007, quit smoking due to pressure and also hating the horrible things, took 3 concerted attempts using Alan Carr, quit for 7 years excluding 2 cigs which were gifted to me out for xmas do with work in 2011, No desire to start again.

Fast forward to Jan last year (2015). Now 4 weeks separated from wife, out for brothers 30th Birthday, friends desperately want a picture of me and my bro drunk and smoking together, I figured why not... such a bad move. 

Newly single out drinking a lot smoking crept back like it had never been away, met a girl who smoked and smoking became a daytime activity too.

Fast forward to xmas 2015, now in new relationship with amazing girl. She doesn't like me smoking but isn't pushing me to stop either. 

I move to a vape because I feel how the cigs are affecting my health.

The past 10 months have been so very very difficult for me, I have attempted to quit around 5 times and end up succumbing and smoking again during stressful times.

I have no idea what to do now, so frustrated, sad, angry at myself.

Help?