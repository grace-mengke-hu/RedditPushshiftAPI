How to quit dokha?

This is my nth attempt to quit.

I've been a smoker for the past 8 years, amd I've been trying to quit since 2017. The longest I  have ever gone is 35 days. It was one the most depressing periods of my life. 

I have read Allen Carr's Easyway, multiple times, and sometimes, I can recognise the nicotine craving for what it is, just a little monster that gets weaker the more I refuse to feed it. I also meditate, infrequently.

Dokha (Arabian tobacco) smoked out of midhwakh (pipe) is like the hardest thing to quit. The headrush it gives is highly addicitve, and synonymous with relief to a smoker going through tension. But, I am trying to hard to reframe this mode of thinking.

My friends addicted to dokha either try to sabotage my quit, or don't help in any way. They are all drinkers too, and even though I'm not much of a drinker, I've decided to quit alcohol too.

I either implode (get depressed) or explode (get angry) when I cannot handle my quit. And, regardless of what Allen Carr says, I cannot control my food cravings. Through all the quit attempts alone, I have gained 15kg, from 90kg to 105kg. I am an emotional eater, even prior to starting smoking.

I want to win this war. Any tips, folks? I don't want to vape, or cut down with cigarettes or any other BS, I just want to do this cold turkey.