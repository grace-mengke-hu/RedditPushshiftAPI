I'm at a loss for where to turn at this point. Feedback welcomed.

Hi,
This is a throwaway obviously, as I am a regular Redditor in other subs. I have been smoking for 20 years. I desperately want to quit. My story of the past two years is so long and complicated but the gist is that my dad died of lung cancer a year ago, at the same time I was going through a major postpartum depressive episode. I never planned to start smoking again after pregnancy (I quit easily) and have always been a closet/social smoker. Nevertheless, 20 years.

I picked up smoking again during this time, and while it may not make sense to start smoking heavily while someone is dying from cancer, this is what I did. It's become a habit so out of control I don't know where to turn. I have major health anxiety at this point and am desperate to quit once and for all.

I read Allen Carr's book. I did not quit smoking.

I did go on a vacation for two weeks this summer and not smoke, because I was with family. I was on cloud 9 when I got home, thinking I was done. I was back smoking within a week.

I am in a vicious cycle of coming home after work and smoking. It's the only time I smoke, but I will do it all night. I also have the same love/hate battle going on with wine at night. 

I want nothing more than to quit smoking but I *feel* like I'm the kind of person who has zero impulse control, who can't find the willpower, who can't translate the facts about smoking into action...I feel helpless and hopeless. What can I do?