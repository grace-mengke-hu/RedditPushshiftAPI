Trying and failing to quit almost every day

Does anyone have advice? I have quit in the past -- once for nearly three years -- and have tried everything from patches to medication to cutting down to cold turkey to Allen Carr. I started smoking again a few months ago after almost a year of abstinence. Now I try pretty much every day to quit and either cave after a few hours or wake up the next morning feeling like garbage and immediately go and get more smokes.

In the past I have set a quit date a couple weeks ahead of time. It seems to help me prepare psychologically but right now I am suffering more acute effects so I'm feeling impatient. My main complaint is insomnia. I know nicotine is a stimulant and yet I can't seem to stop myself smoking well into the night -- with the result that I fall asleep around 4am and get up a few hours later feeling absolutely wrecked.

I'm exhausted... sick and tired of being sick and tired. Please help!