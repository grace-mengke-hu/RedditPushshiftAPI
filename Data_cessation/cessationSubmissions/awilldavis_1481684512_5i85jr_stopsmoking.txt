I "quit" months ago, but I'm still struggling

Hey all, I just found this subreddit and wanted to share my story and maybe get some advice.
I started smoking when I was 18, about three and a half years ago. It was a fun way to hang out with my friends and relax. I started smoking when I would do school work, and that really made it a consistent part of my day. I also dated a girl years back who smoked too, and that helped get me hooked. I smoked throughout the next couple years of college, always saying I would quit before I graduated. 
Last spring I met my current girlfriend, whom I've been dating for almost eight months. She found out I was a smoker not long into us knowing each other. She obviously didn't like it (she has a family history of smoking fucking up lives) but she said she wouldn't tell me to quit. In my need to try and be better than I actually was, I insisted that I would quit soon. She went to Texas for the summer, and I told myself I would quit before she got back. I officially told her I "quit" in early August, but I really haven't. I did quit for a month or so after that, but the first time she went out of town I bought cigarettes and smoked. It's weird, because in my mind I no longer consider myself a "smoker", but if she is out of town or I know I won't see her that day, I often find myself smoking. She only knows I've smoked once since I told her I quit, and it was after a huge fight we had and in a stupid act of rebellion and immaturity I went and bought cigarettes. I haven't told her about the other times. 
I'm struggling with convincing myself I really need to quit. I don't know if I can word this correctly, but I have this strange conception of freedom attached to smoking. It's like those ads warned us about when we were kids: smoking makes you think you're cool. I got into my mind that I was this rebellious type, vulgar academic who smoked (picture a Kurt Vonnegut type folk). It's absolutely insane when I type it out and see it, but it's sort of how I feel. 
I want to quit for my girlfriend. She means more to me than anything else, and overall our relationship is really great. It's just that, deep down, I sometimes wish I could go out for a smoke and not have to be secretive about it. I want to be totally honest with her, but telling her all of this would bode very poorly. And in the end, I need to quit. Suggestions? At this point it's been a couple weeks since I've had a cigarette.