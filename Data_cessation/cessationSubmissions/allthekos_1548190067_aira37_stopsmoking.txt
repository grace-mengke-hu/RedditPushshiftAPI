How do I break the stress/smoke cycle?

I hate smoking and I'm struggling to quit. I've cut down from 20 a day to 10, but want to stop this shit all together. I hate it.

I have tried every NRT, Allen Carr, ecigs.. none of it works for me, so it's pure willpower. I have done well cutting down. I've smoked since i was 13, and I'm 39 now..so its a lifelong addiction. I just feel ill all the time, I can hardly breathe and more than anything I want to live for my kids.

I'm ok if I'm busy, but when I'm alone at night, I start stressing on shit and I instantly get a huge craving and smoke. How do I break this habit, I feel trapped and I'm struggling.. 

