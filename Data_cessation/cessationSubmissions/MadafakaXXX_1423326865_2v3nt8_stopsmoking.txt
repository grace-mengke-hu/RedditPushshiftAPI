My mind hacked the system, please help !

Dear NoFappers and NoSmokers,
I’m big fan of both of this subreddits, reading a lot of articles and trying to challenge myself to get rid of this sick habits for quite some time now. I’m posting to the both subreddits cause they seem to be very connected from my point of view, espacially from the situation I’m now in.
I definitely made some progress about killing both habits and I’m proud of myself for that although I’ve just recently realized I came to really really tricky situation and I just don’t know how to overcome this therefore I’m asking for advice.
First I need to mention that I was heavy smoker then I stoped and now I’m doing this sheeet again. I used to smoke every day 10-15-20 cigarettes for 8 years, then I stopped for 3 years! Not a single cigarette for 3 years! Then I dont even know why and how somehow I started again , just oout of the curiosity? Idk. I just wanted to inform you that I have experience with quiting cold turkey. Now I’m in the point where I do not smoke during the week, when I’m sober but when I go out with friends for a drink I’m done, I smoke like chimney.
As of NoFAP I used to do the „thing“ 1-2-3 times a day every day for couple of years (during the times I was single, like 70% of a time) . After I’ve found out about noFap and forced myself to do the challenge I did the thing maybe 1 a week on average. Now I’m at the same point as with smoking, meaning when I’m sober, during the week I do not have problem at all, no temptation whatsover however when I go out on Friday night I jerk off after 1-2-3 times again.
I’m really scared that I’m stuck and I can not overcome this unless I stop drinking. My record noFAP and noSMOKE is 21 days, thats how long I managed to be without alcohol. I’m scared that my brain is rewired and persuaded that thats how it works, when u are sober you do not these things but when u drink u go for it. Funny thing is that even though I’m clean for 2 weeks for example , on the party day I suddenly have this crazy temptation but I havent had drink YET! I get the temptation just from knowing that tnight I’m going to party I will smoke I will jerk off. And I sometimes go buy cigarettes even before I come to the party? How sick is that?
Meaning its not the taste of alcohol which kills my streak its just my mind playing some sick games but I DONT KNOW HOW TO OVERCOME THIS SHEEEET and EVERYTIME I FAIL I FEEL LIKE IT WILL BE WORSE in the end..... This habit became so strong, I’ve done it like last 20 times. Does anyone have similiar exparience? And Is there anyway to kill this temptation without stoping drinkin?
Please be aware that drinking is important part of my social life. I’m not super alcoholic or anything but I just cannot stand going out with friends to bar / bday party or whatever and not have a beer at least? Also it is probably worth mentioning that I’m from eastern europe and we do drink :D Although if it is really necessary to stop drinking I WILL ! because I want to be done with this shit.
Problem is that if i stop drinking I will avoid to go out , avoid social situations which is really helping me with noFap for example. I’m in this shadyy situations and I feel like I cannot somehow figure it out on my own and I need some help.
Thank you for any opinion about this