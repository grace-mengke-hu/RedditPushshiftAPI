After countless tries, this has to be the final

I was never a chain smoker or anything, but I had 5-10 a day for years. It is time for me to stop. Don't get me wrong, I've tried to quit like 10 times. The longes period was 1 whole year. But eventually I always ended up lighting another one. My girlfriend said nothing about it for 5 years, but after so many promises and failures of quitting, she finally had enough. 

She gave me an ultimatum: no more promises, quit or not, you have to decide id like a man.

So here I am, sharing my thoughts after 6 hours since the last piece.

I want to ask for help guys. I'm pretty sure that I can handle this when nobody is around. How can you deal such situations like at the workplace? All your colleagues are smoking and you really don't want to miss the conversation. It is really hard to stand with them without a cig in my hand.

The other thing is the alcohol. If I drink a couple of beers, it is nearly impossible to resist.

Any advice? I've tried e-cigs but it just gives me a false sensation, the movement and the activity remains.

Stay strong, it was good to read other posts.