I need some tips please

I have severe and constant depression and anxiety among other things and those really fuel my smoking, especially since in incapable of leaving the house ever (maybe once a month to go to a show or something) but I also live in a house with a lot of friends and we all share space and have communal cigarettes and everyone smokes inside. I've been smoking for maybe 7 years and all quitting attempts have failed. It's getting really bad though, I'm in pretty bad shape health wise and the cigarettes make it really hard for me to breathe, I can't walk upstairs without coughing/gagging/throwing up because of them. Does anyone have any tips on quitting when I'm completely surrounded by smoke 100% of the time?