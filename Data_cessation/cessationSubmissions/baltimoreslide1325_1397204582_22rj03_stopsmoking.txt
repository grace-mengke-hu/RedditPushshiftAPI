Messed up. Feel awful. Could use some help.

Just wrote a long, long, rambly post that my computer mercifully deleted.
  
I made it 7 days, then messed up. Just now.  
  
I was a light, but very addicted, smoker. I was also a recreational drinker, and in the last few years, a bunch of personal shit has hit the fan in my life (ex-communicated from abusive family) and my use of all substances got way weirder and more addict-y, which I hated, and which is why I was quitting smoking and making a new start. (I pulled back on the alcohol thing as soon as I realized what was happening, maybe 8 months ago. I didn't have a drinking problem for very long, but I'll always have to watch it. For example, when I can't smoke, sometimes my emotions still make me want to get shitfaced.)  
  
I'm pretty sure my issues with smoking are totally mental. I'm in therapy, know how to meditate, yadda yadda, and am good (too good?) at self-analysis. But I feel like hell. Tonight I just felt horribly vulnerable. I'm not sure I can make it. I'm going to start over, and could use some "it gets better" talk, or any other advice.  
  
I'm also a writer and sometimes lose hope that I can function under the psychological stress of writing without substances, but that is such bullshit.   
  
Not feeling great about myself right now, but I also know that I can do this. Not sure how to go about my next few days, I guess.  
  
Thanks redditors. I seriously love you guys, even though you're strangers. I don't know where else I'd be able to talk about this and get advice. You're all awesome, and thank you tons in advance.