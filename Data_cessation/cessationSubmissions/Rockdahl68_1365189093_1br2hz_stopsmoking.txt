Has anyone tried hypnosis?

I really want to quit. I've been smoking for 11 years, and I've been trying to quit for a couple years now. I've tried the patch and broke out in a rash. I've tried the gum and I just didn't like it. I've tried cold turkey, and I cried for 3 weeks and gained 15 pounds. I really don't want to do any medication because the possible side effects terrify me. I have a history of mental illness and have been stable for several years. Even the smallest chance that I might relapse is not worth the risk.
I've come to the option of hypnosis. I have two friends that it worked like a charm for, and two that started smoking again within a few weeks. I know it's very expensive, but if it will work I'll take the financial hit. I just don't know if it will work for me.
Any advice is greatly appreciated. I've been lurking for a long time and I'm hitting a wall. 