Bored

Hey guys, I am a student at uni and i want to stop smoking. I have been smoking for 7 and a half years. I have the tendency to smoke when
1. i'm stuck on a problem (questions)
2. I'm coding
3. I'm drinking alcohol (during parties)
4. I'm alone with no one to talk to.E.g. if i am yearly to a class, i have nothing to do and thus smoke to let time go.
I have tried to reduce the amount of cigs i smoke daily (from a pack of 20 to 4-6 daily). 
I also get cravings accompanied with lack of focus and extreme headaches. 
All the friends in my circle smoke and this accentuates my cravings. I am trying to change my circle of friends to one who have the same goals as me.
I have f
Could you give me some tips