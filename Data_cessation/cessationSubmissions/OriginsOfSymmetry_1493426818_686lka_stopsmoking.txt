I need help please.

I want to propose to my girlfriend who has always been supportive and kind to me. I swore to myself that I wanted to stop my bad habits because they have never been a part of her life I have a ring and a date set. 3 weeks ago I quit smoking weed, smoking cigs, and started eating healthier but here I stand smoking a cig and I'm disappointed in myself. 

Does anyone have any good tips for when life gets stressful and the cravings get really bad? I know I can do this and already have gone 3 weeks. She deserves better, I owe it to myself to show i can do this. I just feel really defeated right now.