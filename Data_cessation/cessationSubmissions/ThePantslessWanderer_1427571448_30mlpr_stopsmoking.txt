I'm in that "just one last cigarette" phase and need help getting out

I know we've all been there but I just can't get out of this cycle. I'm just having a stressful time in my life and cigarettes are like a pacifier or something where I'm really stressed and crying or just can't function and since I'm a university student I'll be like "you know, do what you need to do to get through this day and get your work done" so I'll go and buy a pack and smoke and I'll feel better and do my work or whatever and then I throw the pack out and the next day it's the same thing. 

How have you guys actually made your last cigarette your last one? It's just that right now I don't even want to quit I like smoking and need it to cope with stress but it gives me headaches and so I know I have to quit but in the past (I had previously not smoked for about 6 months) I actively wanted to quit and actively didn't want to smoke but I don't know how to make myself quit when I want to keep smoking. If I could choose I'd rather make my headaches go away so I can keep smoking. How do I get out of this?