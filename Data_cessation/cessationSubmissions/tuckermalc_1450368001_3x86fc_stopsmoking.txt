In serious need of help

I'm 30 y.o. male been smoking on-and-off since 15, not a heavy smoker but vary between 0-5 cigarettes daily. Over time have tried hundreds of time to quit, always relapsed. Have switched now to those really really slim korean ciggies but would like to quit altogether. Have read many books, articles, basically done every intellectual thing out there to KNOW the various ways to quit. but at a gut level, it has become an identity issue. i still hold on to the false belief that smoking makes me cooler than others, also there is the question occasional celebration with alcohol where I am most weak. Usually when I drink I have to smoke as well. Even less frequent is the marijuana use (once in several months) that makes me roll back to day 0. Any help would do. I would like to continue to be able to drink and dope at parties etc.