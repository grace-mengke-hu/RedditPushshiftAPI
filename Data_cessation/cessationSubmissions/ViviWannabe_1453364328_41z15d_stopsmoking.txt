Smoking and mental illness

So, I have major depressive disorder. I have been trying unsuccessfully to quit smoking for almost three years. My primary reason for wanting to quit is that I have been approved for breast reduction surgery due to back pain, but they won't do the surgery until I have been nicotine free for 30 days (they do a blood test). My problem is that every time I try to quit cold turkey I get about a week in and start having suicidal ideations. So I did the patch. I was very good while on the patch and had maybe three cigs the whole time (moments of weakness). I put on my last patch on Saturday. On Sunday, I had a depressive episode which I am just now starting to come out of. I smoked two cigarettes yesterday and three today. I started on Wellbutrin yesterday and it seems to be helping but doesn't eliminate the problem entirely. I was told that it takes a while to build up in your system and I think it might help more if I just give it time, but I can't seem to stay away in the meantime. I don't want to be suicidal, it scares the crap out of me. How the hell does one quit while battling mental illness? I want to quit so bad, but I also don't want to kill myself.