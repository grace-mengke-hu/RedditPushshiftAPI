Blew off my fiancee for a smoke, this needs to stop.

So I've been off and on (mostly on) the smoking train for the last 8 years or so.  I was a pack a day smoker for a brief period, and usually flucutated between 5 and 10 a day for most of that time. I've 'wanted' to quit for most of that time, but I was able to justify it to myself by saying 'just one more...' over and over again.  Just one more cigarette.  Just one more pack.  Just one more day.  Just one more... It has dominated my social life (I met most of my friends through smoking.  I met my fiancee smoking at work.)

A year ago I decided that I wanted to quit for good.   And true to my word, I haven't purchased a pack of cigarettes in all that time.  But I've been a bum.  I've been a terrible, terrible bum, usually having at least 3 or 4 few every week. My fiancee was much more successful at quitting than me, and I was so proud of her for it.  But for me it's been a continuation of the 'just one more' mentality that I've struggled with for years.

Today we finally had a break scheduled together (we work together).  She has been taking walks during her breaks.  I would take them with her when we had our breaks together, but they've been scheduled separately for a long time.  When we got outside, our friend from whom I bum most of my cigarettes (I lied, I have bought him a few packs as compensation) came out too.

For some reason, I couldn't resist the appeal of smoking one.  I can't smoke around my fiancee since that would be rude.  But blowing off our walk to smoke was even worse.  She was hurt that I didn't accompany her, and I feel terrible.

I don't want to lose her over this kind of thing.  I want my actions to speak for me.  I need help, reddit. How do I stop saying 'just one more' and finally leave smoking behind me for good?