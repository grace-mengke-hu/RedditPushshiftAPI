Ditched a friend because I was afraid

I have a friend who flies out of town tomorrow for school. We did happy hour, where I managed to sip on iced tea. A number of other good friends came, chatted, shoot the shit, and they all went out for more drinks. It took me some tremendous willpower to say no because I was afraid that I'd smoke. I feel terrible, sad and a bit depressed knowing that I'm missing out on some good times because of fear. Now I want a smoke more than ever. 