Need help/advice

I’m currently a week into my 5th or 6th quit attempt now. I’m almost always all good on my own for a month or so until something triggers me. Not myself or drinking or feeling sad or anything, I can deal with that. It’s always other friends/people. The moment a friend or acquaintance smokes in front of me I get this overwhelming urge and I usually break. What’s the absolute worst is one particular friend who’s a chronic smoker knows I’m trying to quit yet keeps purposefully tempting me. Saying stuff like “I’m having a smoke wanna join me?” And when I say no he smirks and says “Cool I’ll ask you again after you’ve had another drink.” So fucked, really resent him for that.

How do I deal with this? Do I just stop seeing these people or should I figure out my own stuff to instill more willpower, or both? Any advice and tips would be much appreciated. I really fucking hate smoking and resent myself every time I break. My fiancées parents both died of lung cancer (first from passive smoking and the second from chronic smoking). We want to have kids soon and it would destroy me if I did that to her and my future children too. 