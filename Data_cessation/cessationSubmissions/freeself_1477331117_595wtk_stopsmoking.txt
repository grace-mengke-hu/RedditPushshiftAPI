And REDO!

So I went out Dancing on the weekend. Since stopping smoking I have avoided usual hangouts and avoided going to or out with smoking friends (basicly all of them) at all costs. This weekend I really wanted to go dancing and there was a great Soundsystem event on in another city about an hour away where i know noone. I thought "fantastic, no pressure, just good vibes and music". When i got there iw as abit more nervous than i thought i would be in regards to not knowing anyone there or in the city. Im not sure why, im not usually bothered. So long story shorter,  after about an hour or so of dancing like a crazy person I went outside for some fresh air (seriously, it was stuffy inside). Im stood there like a loner feeling abit socialy awkward when I get a sudden internal push and I walk over to a group of people and bum a smoke.
I lit it as quick as i could and felt the sweet relief of conversation and getting to know someone. Over the course of the night i smoked 2 cigs and 1 joint... and i regret it, but i have nooo desire to smoke now atall. 

Im annoyed at myself for smoking BUT I think it led me to have a better night and relieve my feelings of awkwardness. Now the question is - How the hell do I deal with similar situations without having a smoke or two?? I guess Im only "safe" going out dancing with my non smoking friend? any thoughts? 

EDIT: Although i smoked, i still got through the night with NO alcohol! Im also stopping drinking so  i dont consider the night a complete failuer :) still proud of not drinking! 