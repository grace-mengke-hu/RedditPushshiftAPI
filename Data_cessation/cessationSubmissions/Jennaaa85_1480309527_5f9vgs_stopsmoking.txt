how do i talk to my husband about quitting? he's giving me asthma attacks?

i'm not a smoker, but my husband smokes about a pack a day. We have been married for 5 years. I have asthma and a heart problem. when we got married and moved in together he agreed he would quit smoking. it was my wedding present. he won't and it's been 5 years. 

he smokes outside now, but he smokes in the house when i'm out of town and lies about it. we almost got evicted because the landlord found out and it's a lease violation. he smokes in the car. if we are walking somewhere he smokes in front of me. sometimes chain smokes. 

i've had a lot more asthma atracks and more heart issues and i've been in the hospital a lot more. a few times a year now. my health hasn't been this bad in 10 years but he's not taking it seriously. i used to be able to go jogging but now i can't walk fast without getting an attack. 

 he stopped entirely for a month right when we got married 5 years ago but went back to it and now says he doesn't want to quit, and that he's going to keep smoking for as long as he wants to. 

i'm trying really hard not to be judgmental. i knew he was a smoker when i married him, but he promised he was quitting. i feel betrayed that even knowing i have such serious health problems he still lights up around me. if I start coughing he acts like i'm a big inconvienence and makes me feel guilty. 

i don't know how to talk about it with him without him feeling attacked. i try to be supportive on the days he doesn't have a cigarette in front of me and give him positive reinforcement. when i get really sick and i comment i need him to quit so i can stop being so sick he usually gets mad and and distant and passive aggressive and smokes a lot more for a few days.

i don't know how he feels about this other than atracked. he won't talk about it. i don't know how to make him feel like he's deeply loved while getting him to understand this is really bad for me to be around. i don't know how to approach this. my pulmonologost told me go stay with family til he quits, but i feel like this is extreme? i feel like if i did that, he would get so upset that our marriage would be over. 

so I'm asking , begging, for advice from people who have smoked. how can i inspire him to take this seriously and try to quit and understand what he's doing to my health without him feeling attacked? 