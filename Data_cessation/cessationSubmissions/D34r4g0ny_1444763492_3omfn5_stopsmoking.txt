He smokes and I'm trying not to.

I've been trying to quit since August. I do well for about a week or two, and then my anxiety really starts to kick in. I realize that I'm much happier when I don't smoke. I am somehow able to wake up earlier and be more productive in my day. 
My problem is, everyone in my life smokes; including my best friend. 
He's the one that I'm usually with all the time, and he only smokes half or so of a cigarette at a time. 
Obviously, I don't want to stop hanging out with him, but when he lights up and offers one to me, I can't resist the temptation. The first few times, yes, but not after the third or fourth. 
What can I do? He's not going to stop smoking around me, and I don't want to cut him out of my life until I feel able to be more disciplined. 
Any advice? 